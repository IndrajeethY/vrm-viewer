# ã€Three.jsã€‘VRMãƒ¢ãƒ‡ãƒ«ã¨VRMAã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ä½¿ã£ãŸWebãƒ“ãƒ¥ãƒ¼ã‚¢ãƒ¼ã‚’ä½œæˆã—ã¦ã¿ãŸ

## ã¯ã˜ã‚ã«

VRMï¼ˆVirtual Reality Modelï¼‰ã¯ã€VRã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å‘ã‘ã®äººå‹3Dã‚¢ãƒã‚¿ãƒ¼ãƒ•ã‚¡ã‚¤ãƒ«ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã§ã™ã€‚ã“ã®è¨˜äº‹ã§ã¯ã€Three.jsã‚’ä½¿ã£ã¦VRMãƒ¢ãƒ‡ãƒ«ã‚’è¡¨ç¤ºã—ã€VRMAï¼ˆVRM Animationï¼‰ã§ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å†ç”Ÿã§ãã‚‹Webãƒ“ãƒ¥ãƒ¼ã‚¢ãƒ¼ã‚’ä½œæˆã—ãŸéç¨‹ã¨æŠ€è¡“çš„ãªãƒã‚¤ãƒ³ãƒˆã‚’ç´¹ä»‹ã—ã¾ã™ã€‚

## ğŸ® ãƒ‡ãƒ¢

å®Ÿéš›ã«å‹•ä½œã™ã‚‹ãƒ‡ãƒ¢ã¯ã“ã¡ã‚‰ã‹ã‚‰ã”è¦§ãã ã•ã„ï¼š
**[VRM Viewer Demo](https://TK-256.github.io/vrm-viewer/)**

![VRM Viewer Demo](https://github.com/TK-256/vrm-viewer/blob/main/demo.gif)

## ç‰¹å¾´

- ğŸ“± **ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãƒ‡ã‚¶ã‚¤ãƒ³**: ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—ãƒ»ãƒ¢ãƒã‚¤ãƒ«å¯¾å¿œ
- ğŸ­ **VRM 1.0ã‚µãƒãƒ¼ãƒˆ**: VRMãƒ¢ãƒ‡ãƒ«ã®èª­ã¿è¾¼ã¿ã¨è¡¨ç¤º
- ğŸ¬ **VRMAã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³**: ã‚«ã‚¹ã‚¿ãƒ ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ã®å†ç”Ÿ
- ğŸ® **ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–æ“ä½œ**: å†ç”Ÿãƒ»ä¸€æ™‚åœæ­¢ãƒ»åœæ­¢åˆ¶å¾¡
- ğŸ¨ **ãƒ¢ãƒ€ãƒ³UI**: ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ™ãƒ¼ã‚¹ã®ç¾ã—ã„ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹
- âš¡ **é«˜é€Ÿãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹**: æœ€é©åŒ–ã•ã‚ŒãŸãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°

## ä½¿ç”¨æŠ€è¡“

### ä¸»è¦ãƒ©ã‚¤ãƒ–ãƒ©ãƒª

- [Three.js](https://threejs.org/) - 3Dã‚°ãƒ©ãƒ•ã‚£ãƒƒã‚¯ã‚¹ãƒ©ã‚¤ãƒ–ãƒ©ãƒª
- [@pixiv/three-vrm](https://github.com/pixiv/three-vrm) - VRMãƒ¢ãƒ‡ãƒ«ã‚µãƒãƒ¼ãƒˆ
- [@pixiv/three-vrm-animation](https://github.com/pixiv/three-vrm-animation) - VRMAã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã‚µãƒãƒ¼ãƒˆ

### æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

- **ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰**: HTML5, CSS3, ES6+ JavaScript
- **3Dãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°**: Three.js WebGLRenderer
- **ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³**: Three.js AnimationMixer
- **ãƒ‡ãƒ—ãƒ­ã‚¤**: GitHub Pages

## ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹æˆ

```
vrm_viewer/
â”œâ”€â”€ index.html              # ãƒ¡ã‚¤ãƒ³ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³
â”œâ”€â”€ VRM/
â”‚   â””â”€â”€ ãƒ­ãƒ³ã‚°å¥³ã®å­1.vrm     # ã‚µãƒ³ãƒ—ãƒ«VRMãƒ¢ãƒ‡ãƒ«
â”œâ”€â”€ VRMA/
â”‚   â”œâ”€â”€ original_01.vrma    # é ­ã†ãªãšãã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
â”‚   â””â”€â”€ original_02.vrma    # è…•æŒ¯ã‚Šã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
â”œâ”€â”€ README.md               # è‹±èªç‰ˆãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
â””â”€â”€ README-jp.md           # æ—¥æœ¬èªç‰ˆãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
```

## å®Ÿè£…ã®ãƒã‚¤ãƒ³ãƒˆ

### 1. VRMãƒ¢ãƒ‡ãƒ«ã®èª­ã¿è¾¼ã¿

```javascript
// GLTF Loader with VRM Plugin
const loader = new GLTFLoader();
loader.register((parser) => {
    return new VRMLoaderPlugin(parser);
});

async function loadVRM(url) {
    return new Promise((resolve, reject) => {
        loader.load(url, (gltf) => {
            const vrm = gltf.userData.vrm;
            
            // ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–
            VRMUtils.removeUnnecessaryVertices(gltf.scene);
            VRMUtils.combineSkeletons(gltf.scene);
            VRMUtils.combineMorphs(vrm);
            
            // ãƒ•ãƒ©ã‚¹ã‚¿ãƒ ã‚«ãƒªãƒ³ã‚°ã‚’ç„¡åŠ¹åŒ–
            vrm.scene.traverse((obj) => {
                obj.frustumCulled = false;
            });
            
            scene.add(vrm.scene);
            vrm.scene.rotation.y = Math.PI; // ãƒ¢ãƒ‡ãƒ«ã‚’æ­£é¢ã«å›è»¢
            currentVrm = vrm;
            
            resolve(vrm);
        });
    });
}
```

### 2. VRMAã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã®å‡¦ç†

```javascript
// VRMA Animation Plugin
loader.register((parser) => {
    return new VRMAnimationLoaderPlugin(parser);
});

async function loadVRMA(url) {
    return new Promise((resolve, reject) => {
        loader.load(url, (gltf) => {
            const vrmAnimationData = gltf.userData.vrmAnimations && gltf.userData.vrmAnimations[0];
            
            if (vrmAnimationData) {
                // VRMã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã‹ã‚‰Three.js AnimationClipã‚’ç”Ÿæˆ
                const clip = createVRMAnimationClip(vrmAnimationData, currentVrm);
                vrmaAnimationClip = clip;
                resolve(clip);
            }
        });
    });
}
```

### 3. ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³åˆ¶å¾¡

```javascript
function playAnimation() {
    if (currentVrm && vrmaAnimationClip && currentMixer) {
        // æ—¢å­˜ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’åœæ­¢
        if (currentAction) {
            currentAction.stop();
        }
        
        // æ–°ã—ã„ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’ä½œæˆ
        currentAction = currentMixer.clipAction(vrmaAnimationClip);
        currentAction.setLoop(THREE.LoopRepeat);
        currentAction.clampWhenFinished = true;
        currentAction.reset();
        currentAction.play();
    }
}
```

### 4. ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ãƒ«ãƒ¼ãƒ—

```javascript
const clock = new THREE.Clock();

function animate() {
    requestAnimationFrame(animate);
    
    const deltaTime = clock.getDelta();
    
    // VRMã¨ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ãƒŸã‚­ã‚µãƒ¼ã®æ›´æ–°
    if (currentVrm) {
        currentVrm.update(deltaTime);
    }
    if (currentMixer) {
        currentMixer.update(deltaTime);
    }
    
    controls.update();
    renderer.render(scene, camera);
}
```

## VRMAã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã®ä½œæˆ

ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã¯ã€ã‚ªãƒªã‚¸ãƒŠãƒ«ã®VRMAã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ã‚’2ã¤ä½œæˆã—ã¾ã—ãŸï¼š

### original_01.vrma - é ­ã†ãªãšãã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
- **å‹•ä½œ**: è‡ªç„¶ãªé ­ã®ã†ãªãšãå‹•ä½œ
- **ç¶™ç¶šæ™‚é–“**: 6ç§’
- **æŠ€è¡“**: VRMãƒ’ãƒ¥ãƒ¼ãƒãƒã‚¤ãƒ‰ãƒœãƒ¼ãƒ³ä»•æ§˜ã«æº–æ‹ ã—ãŸæ­£ç¢ºãªãƒœãƒ¼ãƒ³ãƒãƒƒãƒ”ãƒ³ã‚°

### original_02.vrma - è…•æŒ¯ã‚Šã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
- **å‹•ä½œ**: å·¦å³ã®è…•ã‚’äº¤äº’ã«æŒ¯ã‚‹å‹•ä½œ
- **ç¶™ç¶šæ™‚é–“**: 4ç§’
- **æŠ€è¡“**: ä¸Šè…•ã¨å‰è…•ãŒé€£å‹•ã—ãŸè‡ªç„¶ãªå‹•ã

ä¸¡ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã®ç‰¹å¾´ï¼š
- âœ… å®Œå…¨ã‚ªãƒªã‚¸ãƒŠãƒ«ã§è‘—ä½œæ¨©ãƒ•ãƒªãƒ¼
- âœ… VRM 1.0ä»•æ§˜å®Œå…¨å¯¾å¿œ
- âœ… 709ãƒ•ãƒ¬ãƒ¼ãƒ ã®é«˜ç²¾åº¦ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
- âœ… 91ãƒãƒ£ãƒ³ãƒãƒ«ã®å®Œå…¨ãªãƒœãƒ¼ãƒ³æ§‹é€ 

## ãƒ‡ãƒ—ãƒ­ã‚¤ã¨GitHub Pagesè¨­å®š

### 1. ãƒªãƒã‚¸ãƒˆãƒªä½œæˆ
```bash
git init
git add .
git commit -m "Initial commit"
git branch -M main
git remote add origin https://github.com/YOUR-USERNAME/YOUR-REPOSITORY-NAME.git
git push -u origin main
```

### 2. GitHub Pagesæœ‰åŠ¹åŒ–
1. ãƒªãƒã‚¸ãƒˆãƒªã®Settingsã«ç§»å‹•
2. ã€ŒPagesã€ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§ã€ŒDeploy from a branchã€ã‚’é¸æŠ
3. ãƒ–ãƒ©ãƒ³ãƒã‚’ã€Œmainã€ã€ãƒ•ã‚©ãƒ«ãƒ€ã‚’ã€Œ/ (root)ã€ã«è¨­å®š
4. ã€ŒSaveã€ã‚’ã‚¯ãƒªãƒƒã‚¯

### 3. ãƒ‡ãƒ¢ã‚¢ã‚¯ã‚»ã‚¹
`https://YOUR-USERNAME.github.io/YOUR-REPOSITORY-NAME/` ã§ãƒ‡ãƒ¢ã«ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½

## æŠ€è¡“çš„ãªèª²é¡Œã¨è§£æ±ºç­–

### 1. CORSå•é¡Œ
**å•é¡Œ**: ãƒ­ãƒ¼ã‚«ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ã‚¯ã‚»ã‚¹æ™‚ã®CORSåˆ¶é™
**è§£æ±º**: ãƒ­ãƒ¼ã‚«ãƒ«Webã‚µãƒ¼ãƒãƒ¼ã®ä½¿ç”¨ã‚’æ¨å¥¨

```bash
# Python
python -m http.server 8000

# Node.js
npx serve .

# PHP
php -S localhost:8000
```

### 2. ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³äº’æ›æ€§
**å•é¡Œ**: VRMAãƒ•ã‚¡ã‚¤ãƒ«ã¨VRMãƒ¢ãƒ‡ãƒ«ã®äº’æ›æ€§ç¢ºä¿
**è§£æ±º**: VRM 1.0ãƒ’ãƒ¥ãƒ¼ãƒãƒã‚¤ãƒ‰ä»•æ§˜ã«å®Œå…¨æº–æ‹ ã—ãŸã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ä½œæˆ

### 3. ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–
**å•é¡Œ**: å¤§ããªVRMãƒ•ã‚¡ã‚¤ãƒ«ã§ã®æç”»æ€§èƒ½
**è§£æ±º**: VRMUtilsã‚’ä½¿ç”¨ã—ãŸæœ€é©åŒ–å‡¦ç†

```javascript
VRMUtils.removeUnnecessaryVertices(gltf.scene);
VRMUtils.combineSkeletons(gltf.scene);
VRMUtils.combineMorphs(vrm);
```

## ãƒ–ãƒ©ã‚¦ã‚¶å¯¾å¿œçŠ¶æ³

- âœ… Chrome 80+
- âœ… Firefox 75+
- âœ… Safari 14+
- âœ… Edge 80+

## ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºæ–¹æ³•

### æ–°ã—ã„ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã®è¿½åŠ 

1. VRMAãƒ•ã‚¡ã‚¤ãƒ«ã‚’`VRMA/`ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«é…ç½®
2. `index.html`ã®`VRMA_ANIMATION_URLS`é…åˆ—ã‚’æ›´æ–°
3. HTMLã«å¯¾å¿œã™ã‚‹ãƒœã‚¿ãƒ³ã‚’è¿½åŠ 

```javascript
const VRMA_ANIMATION_URLS = [
    '/VRMA/original_01.vrma',
    '/VRMA/original_02.vrma',
    '/VRMA/your_new_animation.vrma', // æ–°ã—ã„ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
];
```

### UI ã®ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º

CSSã‚«ã‚¹ã‚¿ãƒ ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã§ãƒ†ãƒ¼ãƒã‚’ç°¡å˜ã«å¤‰æ›´ã§ãã¾ã™ï¼š

```css
.controls button {
    background: linear-gradient(145deg, #6a82fb, #fc5c7d);
    /* ãŠå¥½ã¿ã®ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã«å¤‰æ›´ */
}
```

## ã¾ã¨ã‚

Three.jsã¨VRMãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã§ã€æ¯”è¼ƒçš„ç°¡å˜ã«VRMãƒ“ãƒ¥ãƒ¼ã‚¢ãƒ¼ã‚’ä½œæˆã§ãã¾ã—ãŸã€‚ç‰¹ã«ä»¥ä¸‹ã®ç‚¹ãŒé‡è¦ã§ã—ãŸï¼š

1. **VRM 1.0ä»•æ§˜ã¸ã®æº–æ‹ **: ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³äº’æ›æ€§ã®ãŸã‚
2. **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–**: VRMUtilsã®æ´»ç”¨
3. **GitHub Pages**: ç°¡å˜ãªãƒ‡ãƒ—ãƒ­ã‚¤ã¨ãƒ‡ãƒ¢å…±æœ‰

VRMã‚¨ã‚³ã‚·ã‚¹ãƒ†ãƒ ã¯ä»Šå¾Œã‚‚ç™ºå±•ãŒæœŸå¾…ã•ã‚Œã‚‹åˆ†é‡ãªã®ã§ã€å¼•ãç¶šãæŠ€è¡“å‹•å‘ã‚’è¿½ã£ã¦ã„ããŸã„ã¨æ€ã„ã¾ã™ã€‚

## å‚è€ƒãƒªãƒ³ã‚¯

- [GitHub Repository](https://github.com/TK-256/vrm-viewer)
- [Live Demo](https://TK-256.github.io/vrm-viewer/)
- [VRM Consortium](https://vrm.dev/)
- [Three.js](https://threejs.org/)
- [@pixiv/three-vrm](https://github.com/pixiv/three-vrm)

## ã‚¿ã‚°
#Three.js #VRM #WebGL #JavaScript #GitHub Pages #3D #Animation